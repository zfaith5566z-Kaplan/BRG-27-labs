Bash Backup Scripting, Cron Jobs & Cloud Export

This lab introduces Bash scripting for creating file backups, scheduling them using cron jobs, and exporting them to the cloud. Students will use scripting logic to automate folder archiving, apply timestamps to filenames, and securely upload backups to remote servers.
Learning Objectives
â€¢	- Write Bash scripts to automate tasks (backup, compression, cloud transfer).
â€¢	- Use variables, loops, and conditional expressions in Bash.
â€¢	- Schedule automated tasks using cron jobs.
â€¢	- Move scripts to /usr/bin for system-wide availability.
â€¢	- Export backup files to a cloud server using `scp` and secure keys.
â€¢	- Explore boot-time execution and user login enhancements (figlet/neofetch).
Lab Steps
â€¢	- Create test files and directories in `/home/ubuntu/Documents`. / /
â€¢	- Write a Bash script to recursively copy `/Documents` to `/backup`.
â€¢	- Zip the backup with a filename based on current date using `date` and `zip`.
â€¢	- Move the final backup zip into `/home/ubuntu` for easy access.
â€¢	- Grant execute permissions: `chmod 777 testscript`.
â€¢	- Move script to `/usr/bin/` and test system-wide execution.
â€¢	- Schedule cron to run the script hourly: edit `/etc/crontab`.
â€¢	- Add an SCP command to transfer the backup to a cloud instance.
â€¢	- Test key-based SSH access and accept remote host fingerprints if prompted.
Sample Script Breakdown
â€¢	now=$(date +"%d_%m_%y")
â€¢	cp -R /home/ubuntu/Documents/* /home/ubuntu/backup/
â€¢	zip -r $now.zip /home/ubuntu/backup/*
â€¢	cp $now.zip /home/ubuntu/
â€¢	scp -i /home/ubuntu/key.pem $now.zip ubuntu@your.cloud.server:/home/ubuntu/
Extension Tasks and Challenges
â€¢	Challenge 1 â€“ Boot-Time Execution: Configure the script to run at system startup using rc.local or systemd.
â€¢	Challenge 2 â€“ MOTD Customisation: Use `figlet` and `neofetch` to personalise the message of the day when users log in.
Reflection Questions
â€¢	- Why is using absolute paths important in scripts run by cron?
â€¢	- What are the benefits of cloud exporting for backups?
â€¢	- How does cron differ from manual execution?
â€¢	- What happens if SSH keys are not accepted ahead of time?
â€¢	- How can login messages help improve user/system engagement?

This was the most satisfying lab. Turning a manual, error-prone process into a silent, reliable guardian for my data.
â€¢	Using absolute paths in cron scripts is critical because cron executes jobs with a very minimal environment and a different working directory than your user shell. A relative path like ./backup.sh or ../data/ will almost certainly fail, as cron won't know where to look.
â€¢	The benefit of cloud exporting is the 3-2-1 backup rule: have at least three copies of your data, on two different media, with one copy off-site. Cloud storage is that off-site copy, protecting against physical disasters like fire or theft that would destroy both the live server and a local backup drive.
â€¢	cron differs from manual execution in its environment and its lack of feedback. When I run a script manually, I see any errors printed to my terminal. cron runs in the background and will only notify you via email if it's configuredâ€”and if you check that email. This makes logging within the script itself absolutely essential.
â€¢	If SSH keys are not set up ahead of time, the rsync or scp command in the backup script will hang, waiting for a password that no one is there to provide. This breaks the entire automation and results in a failed backup.
â€¢	Login messages (like those in /etc/motd or from a custom script in /etc/profile.d/) are a powerful but often overlooked communication channel. They can alert all users to upcoming maintenance, warn about system usage policies, or simply display system status (like disk space). This improves engagement by keeping users informed and can prevent problems before they start.

Potential Problems & Reflections:
The silent failure of cron is the single biggest risk in automation. My backup script could fail for weeks due to a full disk, a changed password on the cloud storage, or a network outage, and I'd be none the wiser until I needed to restore. The solution is to build robust error handling and notifications into the script itselfâ€”perhaps having it send an email or a notification to a monitoring service on failure. Another subtle problem is backing up files that are currently being written to, which can result in a corrupted backup. Using tools like lvm snapshots or ensuring applications are quiesced during backup is a more advanced, but necessary, consideration for database-driven applications.


â€ƒ
ðŸ’¾ Activity: Automated Backup Script with Cron and SCP
ðŸ“˜ Objective
Write a Bash script that creates a dated ZIP backup of the /home/ubuntu/Documents directory every hour using cron, and optionally exports it to a remote cloud server using scp.

ðŸ“¦ Deliverables
#	Deliverable	Description
âœ… 1	Practice Bash Commands Executed	Output or screenshots showing:
â€¢ echo, variables
â€¢ Arithmetic with (( ))
â€¢ Basic for loop summation
âœ… 2	Test Files & Directories Created	Screenshot of terminal showing files and folders in /home/ubuntu/Documents/ using ls -R
Had to create an new user called ubuntu and within it created test files
as per deliverable requested.

âœ… 3	Basic Script Working (usescript)	File /home/ubuntu/usescript created and tested with:
â€¢ Recursive copy from Documents to /home/ubuntu/backup/
â€¢ Script has execute permission (chmod 777) and produces expected output
âœ… 4	Script Moved to /usr/bin and Tested	Output showing:
â€¢ Script moved to /usr/bin/usescript
â€¢ sudo chown applied
â€¢ usescript works from any directory
âœ… 5	ZIP Archive with Date Filename	Script updated to:
â€¢ Use zip -r to archive backup
â€¢ Use now=$(date +"%d_%m_%y") to name the ZIP file
â€¢ Screenshot of dated ZIP in /home/ubuntu/
âœ… 6	Cronjob Set Up for Hourly Backup	Screenshot or output of /etc/crontab edited to include:
9 * * * * ubuntu /usr/bin/usescript or similar hourly cron job
âœ… 7	Successful Cron Execution Verified	Evidence that the script runs every hour:
â€¢ ZIP file created hourly
â€¢ Timestamps or ls -lh output confirming multiple backups created
âœ… 8	SCP to Cloud Working	Script contains a line using:
scp -i key.pem $now.zip ubuntu@<server>:~/
â€¢ Confirmed file reached cloud VM (ls ~/ on remote server)
âœ… 9	SSH Certificate Accepted by Root	Output of sudo ssh -i key.pem ... showing manual acceptance of SSH key fingerprint
âœ… 10	Final Script Submitted	Full contents of script provided, with:
â€¢ Dated ZIP backup
â€¢ SCP transfer
â€¢ Full paths used for cron
âœ… 11	Challenge 1: Boot-Time Script (Optional)	Screenshot or output showing script added to /etc/rc.local or systemd service to run at boot
âœ… 12	Challenge 2: neofetch & figlet MOTD (Optional)	Output or screenshot showing customized login greeting using neofetch, figlet, or /etc/motd edits
